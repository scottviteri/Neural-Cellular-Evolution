# Neural Cellular Evolution

This repository contains an implementation of Neural Cellular Automaton (NCA) with convolutional attention in PyTorch. The model uses a specialized attention mechanism to update cell states based on their 3x3 neighborhoods. 

## Core Features

- Efficiently implemented convolutional attention mechanism with proper handling of boundaries
- Logit transformation of target space for improved gradient properties
- Supports training with batch processing for faster convergence
- Visualization tools including animated GIFs of training progress

## Installation

To install the package and its dependencies, you can use:

```bash
# Install in development mode
pip install -e .

# Install with test dependencies
pip install -e ".[dev]"
```

## Running the Model

### Quick Demo

For a quick demonstration, use:

```bash
python -m nca.main --demo
```

This will run the NCA training with default parameters (red circle target, 10000 steps, batch size 8) and save outputs to the `demo_output` directory.

### Custom Training

You can customize training with various command line arguments:

```bash
python -m nca.main --target-type circle --steps 10000 --batch-size 8 --output-dir my_results
```

Available options:

- Target options:
  - `--target-type`: Choose from "solid", "gradient", "checkerboard", "circle"
  - `--target-image`: Path to a custom target image
  - `--size`: Size of the target image (default: 32)
  - `--channels`: Number of channels (default: 3 for RGB)

- Training options:
  - `--steps`: Number of training steps (default: 10000)
  - `--batch-size`: Batch size for training (default: 8)
  - `--lr`: Learning rate (default: 0.001)
  - `--hidden-dim`: Hidden dimension for attention (default: 16)

- Output options:
  - `--output-dir`: Directory to save results (default: "demo_output")
  - `--log-interval`: Interval for saving visualizations (default: 200)

## Project Structure

- `nca/`: Main package
  - `model.py`: NCA model definition and attention mechanism
  - `trainer.py`: Training loop and noise injection
  - `visualization.py`: Visualization utilities
  - `main.py`: Command-line interface and demo functionality
- `tests/`: Unit tests

## Testing

Run the test suite with:

```bash
pytest
```

## Notes

The repository has been streamlined to remove duplicated functionality:

- `run_example.py` has been deprecated and its functionality integrated into `nca.main`
- The `examples/` directory contains older examples that have been superseded by the main module

The `attention_guided_nca.egg-info` directory is generated by the Python packaging system and can be safely ignored. 
